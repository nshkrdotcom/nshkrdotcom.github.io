<!DOCTYPE html>
<html lang="en">
<head>
  {{ partial "head.html" . }}
</head>
<body>
  {{ partial "header.html" . }}

  <main class="main-content">
    {{ block "main" . }}{{ end }}
  </main>

  {{ partial "footer.html" . }}

  <script>
    // Mermaid init: convert Hugo code blocks to mermaid divs
    if (typeof mermaid !== 'undefined') {
      document.querySelectorAll('code.language-mermaid').forEach(function(el) {
        var pre = el.parentElement;
        var div = document.createElement('div');
        div.className = 'mermaid';
        div.textContent = el.textContent;
        pre.parentElement.replaceChild(div, pre);
      });
      mermaid.initialize({
        startOnLoad: true,
        theme: 'dark',
        securityLevel: 'loose',
        themeVariables: {
          darkMode: true,
          background: '#18181b',
          primaryColor: '#3b82f6',
          primaryTextColor: '#fafafa',
          lineColor: '#3f3f46'
        }
      });
    }

    // Heading anchor links
    document.querySelectorAll('h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]').forEach(function(heading) {
      var anchor = document.createElement('a');
      anchor.className = 'header-anchor';
      anchor.href = '#' + heading.id;
      anchor.innerHTML = 'Â¶';
      anchor.setAttribute('aria-hidden', 'true');
      heading.appendChild(anchor);
    });
  </script>
</body>
</html>
